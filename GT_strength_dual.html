<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>GT Strength Emulator (dual view)</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/numeric/1.2.6/numeric.min.js"></script>
<style>
  /* MODIFIED FOR EMBEDDING: Make the page seamless and responsive */
  html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    font-family: system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;
    background: #fff;
    overflow: hidden; /* Prevent any accidental scrollbars */
    display: flex; /* Use flexbox for layout */
    flex-direction: column; /* Stack panel and plot vertically */
  }

  /* MODIFIED: The main container is now a column */
  .row {
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
  }

  /* MODIFIED: The plot now fills all available space */
  #fig {
    flex: 1 1 auto; /* Allow the plot to grow and shrink */
    min-height: 0; /* Important for flexbox shrinking */
    border: none;
  }

  /* MODIFIED: The control panel sits at the top */
  #panel {
    flex: 0 0 auto; /* Panel takes only the height it needs */
    border: none;
    border-bottom: 1px solid #e5e7eb;
    padding: 8px 12px;
    box-sizing: border-box; /* Ensures padding is included in the element's total width and height */
    display: flex; /* Arrange controls horizontally */
    gap: 16px;
    align-items: center;
  }
  
  #panel > div {
    flex: 1; /* Allow slider containers to share space */
  }

  .label { font-size: 12px; color: #374151; display: block; margin-bottom: 2px; }
  input[type="range"] { width: 100%; }
  .value { font-weight: 600; margin-left: 6px; }
</style>
</head>
<body>
<!-- The H2 title has been removed -->
<div class="row">
  <!-- The panel now comes first -->
  <div id="panel">
    <div>
      <span class="label">V0<sup>is</sup> <span id="alphaVal" class="value"></span></span>
      <input id="alpha" type="range" min="0.286" max="1.714" step="0.01" value="1.0">
    </div>
    <div>
      <span class="label">g0 <span id="betaVal" class="value"></span></span>
      <input id="beta" type="range" min="0.143" max="0.857" step="0.01" value="0.5">
    </div>
    <p style="font-size:11px; color:#6b7280; flex-basis: 300px; margin: 0;">
      Drag sliders for live updates.
    </p>
  </div>
  <!-- The plot container comes second and will fill the remaining space -->
  <div id="fig"></div>
</div>

<script>
"use strict";

// ---------------- data from Python ----------------
// DATA object is unchanged
const DATA = {"D":[[1.520756888504426,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[0.0,-3.181266401476001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.08003647994670345,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,-1.0674135187427793,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.06653442015049522,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0673307165309918,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,-0.6496134340241277,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,-1.9983681195731755,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-2.822016124075352,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-6.2843962407514615,0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.7574738905004207,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-5.220559312145273,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.2691922975802186,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,6.940057286876573,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-1.7528878539712816,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.8855641992194098]],"S1":[[-2.575031557256124,0.01615860785989504,1.255851976334994,0.18518918252041738,-0.3446093730750583,0.5758676242935817,-0.05513284337937454,0.23897049163857742,-0.04322923491930301,0.2896473509838158,0.1280934048262192,-0.8589923440258674,-0.7773506228294662,0.8536758205611187,-0.4162610359667398,0.6207559881445082],[0.01615860785989504,0.018065902556055717,-0.23250915432581423,0.25096983726310174,0.10148996281801241,0.022178704231248517,-0.0385657754134054,0.10187049059605117,-0.02359290845141895,0.4703804231565521,-0.25326409450703,0.03241928091619076,0.18846567842193984,-0.5600376801901294,-0.2945722278990734,-0.14960643739548796],[1.255851976334994,-0.23250915432581423,-1.164690637011349,0.04436360028064748,0.6971064520992897,-0.7534340118982101,0.01599333627684104,-0.5564397177865515,-0.36380403025212443,1.1476237211077045,-0.2915597086728746,0.6504048241356937,2.1393152531982245,-1.07927974551745,0.4925384309217792,-0.427566516720616],[0.18518918252041738,0.25096983726310174,0.04436360028064748,-0.004490048235299602,0.14783779959209875,-0.4064594115327302,0.004829104877573314,0.1637464840431917,0.28147681579684375,-1.1202031987572592,0.3432162469966061,0.30179602189927923,-0.6875826408073442,0.20492150061650882,-0.07700690376714461,0.181153522404239],[-0.3446093730750583,0.10148996281801241,0.6971064520992897,0.14783779959209875,-0.6712268535950833,0.5601826764954286,-0.019842906338556544,0.7639762747242012,0.24715933235455018,-0.3208793047819424,0.24513317717234323,-0.5921421016316532,-0.8136177552543873,0.6547626614641563,-0.8750082391506944,-0.2620158244271283],[0.5758676242935817,0.022178704231248517,-0.7534340118982101,-0.4064594115327302,0.5601826764954286,-0.7314735562142203,0.07581905994876532,-1.2778721871248424,-0.13192395107503663,-0.3728616380696423,-0.12722684259786393,0.7555208419209435,-0.43421888897798394,-0.436477089459867,1.5774946888935808,0.05956571758499038],[-0.05513284337937454,-0.0385657754134054,0.01599333627684104,0.004829104877573314,-0.019842906338556544,0.07581905994876532,-0.007176227580356915,-0.003945266553971195,-0.045613591656851804,0.4518450425457083,-0.13066916292635025,-0.055544461163502805,0.07145839092229825,-0.24247370064639165,0.06607143115329543,-0.14755517844237243],[0.23897049163857742,0.10187049059605117,-0.5564397177865515,0.1637464840431917,0.7639762747242012,-1.2778721871248424,-0.003945266553971195,0.23100974200065635,0.037609617814033096,-1.195137174614485,-0.1665879536266603,0.7101034618975023,-0.35207825622323596,-0.03972318834442062,-0.3164359480234241,0.09451240944059704],[-0.04322923491930301,-0.02359290845141895,-0.36380403025212443,0.28147681579684375,0.24715933235455018,-0.13192395107503663,-0.045613591656851804,0.037609617814033096,0.04544334966975252,0.2892094928509703,-0.28618056822137117,0.1806320252626789,0.2861229362028791,-0.3831058073562429,-0.2566154704249475,-0.06732815284917612],[0.2896473509838158,0.4703804231565521,1.1476237211077045,-1.1202031987572592,-0.3208793047819424,-0.3728616380696423,0.4518450425457083,-1.195137174614485,0.2892094928509703,-2.1933298386672093,0.4068173243077686,0.36728097986018543,-0.3742698167617783,0.43796468706099106,2.0074175151896263,-0.1425457050652077],[0.1280934048262192,-0.25326409450703,-0.2915597086728746,0.3432162469966061,0.24513317717234323,-0.12722684259786393,-0.13066916292635025,-0.1665879536266603,-0.28618056822137117,0.4068173243077686,0.478527782089427,0.09864372197542558,1.0215353960697278,0.05220690375591211,0.04872459739384652,0.2151648406799763],[-0.8589923440258674,0.03241928091619076,0.6504048241356937,0.30179602189927923,-0.5921421016316532,0.7555208419209435,-0.055544461163502805,0.7101034618975023,0.1806320252626789,0.36728097986018543,0.09864372197542558,-1.7029996210866767,-0.6390481753907132,0.3600605243959965,-0.580713140624102,-0.31351429438638206],[-0.7773506228294662,0.18846567842193984,2.1393152531982245,-0.6875826408073442,-0.8136177552543873,-0.43421888897798394,0.07145839092229825,-0.35207825622323596,0.2861229362028791,-0.3742698167617783,1.0215353960697278,-0.6390481753907132,-2.2512081978151315,1.5661835998208329,1.2397236551347286,-0.026117463895109425],[0.8536758205611187,-0.5600376801901294,-1.07927974551745,0.20492150061650882,0.6547626614641563,-0.436477089459867,-0.24247370064639165,-0.03972318834442062,-0.3831058073562429,0.43796468706099106,0.05220690375591211,0.3600605243959965,1.5661835998208329,-0.18481041396774314,-0.40256422352100146,-0.14841999438974188],[-0.4162610359667398,-0.2945722278990734,0.4925384309217792,-0.07700690376714461,-0.8750082391506944,1.5774946888935808,0.06607143115329543,-0.3164359480234241,-0.2566154704249475,2.0074175151896263,0.04872459739384652,-0.580713140624102,1.2397236551347286,-0.40256422352100146,0.3834618115976254,-0.3335133206105506],[0.6207559881445082,-0.14960643739548796,-0.427566516720616,0.181153522404239,-0.2620158244271283,0.05956571758499038,-0.14755517844237243,0.09451240944059704,-0.06732815284917612,-0.1425457050652077,0.2151648406799763,-0.31351429438638206,-0.026117463895109425,-0.14841999438974188,-0.3335133206105506,-0.8240776707735198]],"S2":[[0.8809249702010532,0.8972253765297821,-0.2112040105301604,0.481611584210817,-0.43390150100381675,1.9395292090809222,0.7782765081213512,0.1644502957678814,0.12752625663108122,-0.4720215944954684,0.7044785085854348,0.4516422540871042,0.22570536341380848,0.821094395992186,-0.2916750198612348,-0.04260357532683295],[0.8972253765297821,0.22282771857497685,-0.5713925604786971,-0.11600566501657272,0.18584432182014238,0.23504813276779335,-0.23894426118261333,0.2774801715301788,-0.19459244624757022,-0.5116072854870041,0.02322782933279602,0.7380523398099254,-0.577283734095547,1.4748169678195517,-0.8372735675327883,0.3625719204860133],[-0.2112040105301604,-0.5713925604786971,-1.019417712101096,0.7962425721717257,1.5746820344130918,-1.7060190611608215,0.06854442497597524,-0.22607511890933568,-0.4989468388552706,0.13183213635807678,-1.0469470503084477,-0.8572674097891881,-1.27615845498263,0.37722101306690353,0.06313825384288704,-0.5209734259656841],[0.481611584210817,-0.11600566501657272,0.7962425721717257,0.9877849618534054,0.3665045047847064,0.26042724624157787,0.2621626608179491,0.6362957431531193,0.07653242035342225,-0.7625181452692534,-0.2682084816081691,0.0172739805358812,-1.0017869305321452,2.0299540908582494,0.1024753652156325,-0.5410274122553494],[-0.43390150100381675,0.18584432182014238,1.5746820344130918,0.3665045047847064,0.19434972281852092,1.2108414619095027,0.23805719079516707,0.10437918066201383,-0.11440346374142382,0.334013158012073,0.8826472277498352,0.41880310692043893,0.5300989832028707,1.5474516615637146,0.1819577182168562,-0.9351680780722887],[1.9395292090809222,0.23504813276779335,-1.7060190611608215,0.26042724624157787,1.2108414619095027,-0.2905601419520373,-0.10625026433532125,0.3028842585518878,-0.2167038898337201,-1.4530257291296231,-0.5671239008026434,-0.5131422232217061,-0.11599173852367202,-0.6225320223510112,-0.07695542350925479,-0.3930403164742119],[0.7782765081213512,-0.23894426118261333,0.06854442497597524,0.2621626608179491,0.23805719079516707,-0.10625026433532125,1.854581856055067,-0.3902870735979379,-0.5616789762372746,-0.07218257374751126,-0.9702840260934407,-0.5178816887585778,-0.08393481784960286,1.8225229873650486,-0.2748261078520927,-0.1636450395479792],[0.1644502957678814,0.2774801715301788,-0.22607511890933568,0.6362957431531193,0.10437918066201383,0.3028842585518878,-0.3902870735979379,1.3245138315904725,0.14277876196025413,-1.592891395084163,-1.2836663581620589,-0.9634384827872015,-2.1839837484205176,0.45332188472503543,-0.7248038280395964,-0.3168186054727898],[0.12752625663108122,-0.19459244624757022,-0.4989468388552706,0.07653242035342225,-0.11440346374142382,-0.2167038898337201,-0.5616789762372746,0.14277876196025413,0.16637032750968533,-0.5715976189842392,-0.9081887732877855,0.7775571769788455,-0.17017101820891037,-0.5355384285166772,-0.640746351623153,0.3777694849517386],[-0.4720215944954684,-0.5116072854870041,0.13183213635807678,-0.7625181452692534,0.334013158012073,-1.4530257291296231,-0.07218257374751126,-1.592891395084163,-0.5715976189842392,-0.7919276826559597,-0.17042526260524724,-1.348147301932237,0.3172663163204561,-0.15085666148199425,2.2075763188994872,0.21153131061203173],[0.7044785085854348,0.02322782933279602,-1.0469470503084477,-0.2682084816081691,0.8826472277498352,-0.5671239008026434,-0.9702840260934407,-1.2836663581620589,-0.9081887732877855,-0.17042526260524724,-0.7940890038867812,-1.5438984934575644,-2.5111170827891116,-1.0595902377739606,0.8146381753212933,-0.04812444797345846],[0.4516422540871042,0.7380523398099254,-0.8572674097891881,0.0172739805358812,0.41880310692043893,-0.5131422232217061,-0.5178816887585778,-0.9634384827872015,0.7775571769788455,-1.348147301932237,-1.5438984934575644,0.11915740961998902,-1.0110632259591126,0.4674781904027212,-0.0325503082372986,0.29450998828310554],[0.22570536341380848,-0.577283734095547,-1.27615845498263,-1.0017869305321452,0.5300989832028707,-0.11599173852367202,-0.08393481784960286,-2.1839837484205176,-0.17017101820891037,0.3172663163204561,-2.5111170827891116,-1.0110632259591126,-5.007425612175664,-1.1007621253036937,2.8385036479223364,0.5415519482086498],[0.821094395992186,1.4748169678195517,0.37722101306690353,2.0299540908582494,1.5474516615637146,-0.6225320223510112,1.8225229873650486,0.45332188472503543,-0.5355384285166772,-0.15085666148199425,-1.0595902377739606,0.4674781904027212,-1.1007621253036937,6.186752920682939,0.6596805788824907,-1.5368565104274616],[-0.2916750198612348,-0.8372735675327883,0.06313825384288704,0.1024753652156325,0.1819577182168562,-0.07695542350925479,-0.2748261078520927,-0.7248038280395964,-0.640746351623153,2.2075763188994872,0.8146381753212933,-0.0325503082372986,2.8385036479223364,0.6596805788824907,1.4481516890039103,-0.3193033831280441],[-0.04260357532683295,0.3625719204860133,-0.5209734259656841,-0.5410274122553494,-0.9351680780722887,-0.3930403164742119,-0.1636450395479792,-0.3168186054727898,0.3777694849517386,0.21153131061203173,-0.04812444797345846,0.29450998828310554,0.5415519482086498,-1.5368565104274616,-0.3193033831280441,1.1659817123134892]],"v0":[0.954344597871042,0.8117086810249575,0.7250721129729397,1.48181751924837,1.9074494988267188,0.7866678109682099,1.2956037369989104,0.8570560949886675,-0.8558548651672508,-0.18260321548994712,0.22200985003077103,-0.5745344154372686,-0.594841740033159,6.04192472723238,0.6734121017854622,-2.755031556003633],"fold":6.87533416512056e-12,"x1":-0.5160750660247748,"x2":0.0025444829388367317,"x3":0.01138562895764345,"omega":[-8.0,-7.984981226533167,-7.969962453066333,-7.954943679599499,-7.939924906132666,-7.924906132665832,-7.909887359198999,-7.894868585732166,-7.8798498122653315,-7.864831038798498,-7.849812265331664,-7.834793491864831,-7.819774718397998,-7.804755944931164,-7.78973717146433,-7.774718397997497,-7.759699624530663,-7.74468085106383,-7.729662077596997,-7.7146433041301625,-7.699624530663329,-7.684605757196495,-7.669586983729662,-7.654568210262829,-7.639549436795995,-7.624530663329161,-7.609511889862328,-7.594493116395494,-7.579474342928661,-7.564455569461828,-7.5494367959949935,-7.53441802252816,-7.519399249061327,-7.504380475594493,-7.48936170212766,-7.4743429286608265,-7.459324155193992,-7.444305381727159,-7.429286608260325,-7.414267834793492,-7.399249061326659,-7.3842302878598245,-7.369211514392991,-7.354192740926158,-7.339173967459324,-7.324155193992491,-7.3091364205256575,-7.294117647058823,-7.27909887359199,-7.264080100125156,-7.249061326658323,-7.23404255319149,-7.2190237797246555,-7.204005006257822,-7.188986232790989,-7.173967459324155,-7.158948685857322,-7.1439299123904885,-7.128911138923654,-7.113892365456821,-7.098873591989987,-7.083854818523154,-7.068836045056321,-7.053817271589487,-7.038798498122653,-7.02377972465582,-7.008760951188986,-6.993742177722153,-6.9787234042553195,-6.963704630788485,-6.948685857321652,-6.933667083854818,-6.918648310387985,-6.9036295369211516,-6.888610763454318,-6.873591989987484,-6.858573216520651,-6.843554443053817,-6.828535669586984,-6.81351689612015,-6.798498122653317,-6.783479349186483,-6.76846057571965,-6.753441802252816,-6.7384230287859825,-6.723404255319149,-6.708385481852315,-6.693366708385482,-6.678347934918648,-6.663329161451815,-6.648310387984981,-6.633291614518148,-6.618272841051314,-6.603254067584481,-6.588235294117647,-6.5732165206508135,-6.55819774718398,-6.543178973717146,-6.528160200250313,-6.513141426783479,-6.498122653316646,-6.483103879849812,-6.468085106382979,-6.453066332916145,-6.438047559449312,-6.423028785982478,-6.4080100125156445,-6.392991239048811,-6.377972465581978,-6.362953692115144,-6.347934918648311,-6.332916145181477,-6.317897371714643,-6.30287859824781,-6.287859824780976,-6.272841051314143,-6.257822277847309,-6.2428035043804755,-6.227784730913642,-6.212765957446809,-6.197747183979975,-6.182728410513142,-6.167709637046308,-6.152690863579474,-6.137672090112641,-6.122653316645807,-6.107634543178974,-6.09261576971214,-6.0775969962453065,-6.062578222778473,-6.04755944931164,-6.032540675844806,-6.017521902377973,-6.002503128911139,-5.987484355444305,-5.972465581977472,-5.957446808510639,-5.942428035043805,-5.927409261576971,-5.9123904881101375,-5.897371714643304,-5.882352941176471,-5.867334167709637,-5.852315394242804,-5.83729662077597,-5.822277847309136,-5.807259073842303,-5.79224030037547,-5.777221526908636,-5.762202753441802,-5.747183979974968,-5.732165206508135,-5.717146433041302,-5.702127659574469,-5.687108886107635,-5.6720901126408005,-5.657071339173967,-5.642052565707134,-5.627033792240301,-5.612015018773467,-5.5969962453066335,-5.581977471839799,-5.566958698372966,-5.551939924906133,-5.5369211514393,-5.521902377972466,-5.5068836045056315,-5.491864831038798,-5.476846057571965,-5.461827284105132,-5.446808510638298,-5.4317897371714645,-5.41677096370463,-5.401752190237797,-5.386733416770964,-5.371714643304131,-5.356695869837297,-5.3416770963704625,-5.326658322903629,-5.311639549436796,-5.296620775969963,-5.28160200250313,-5.2665832290362955,-5.251564455569461,-5.236545682102628,-5.221526908635795,-5.206508135168962,-5.191489361702128,-5.176470588235294,-5.16145181476846,-5.146433041301627,-5.131414267834794,-5.116395494367961,-5.1013767209011265,-5.086357947434292,-5.071339173967459,-5.056320400500626,-5.041301627033793,-5.026282853566959,-5.011264080100125,-4.996245306633291,-4.981226533166458,-4.966207759699625,-4.951188986232792,-4.9361702127659575,-4.921151439299123,-4.90613266583229,-4.891113892365457,-4.876095118898624,-4.8610763454317905,-4.846057571964956,-4.831038798498122,-4.816020025031289,-4.801001251564456,-4.785982478097623,-4.7709637046307884,-4.755944931163955,-4.740926157697121,-4.725907384230288,-4.710888610763455,-4.695869837296621,-4.680851063829787,-4.665832290362953,-4.65081351689612,-4.635794743429287,-4.6207759699624535,-4.605757196495619,-4.590738423028786,-4.575719649561952,-4.560700876095119,-4.545682102628286,-4.530663329161452,-4.515644555694618,-4.500625782227784,-4.485607008760951,-4.470588235294118,-4.4555694618272845,-4.440550688360451,-4.425531914893617,-4.410513141426783,-4.39549436795995,-4.380475594493117,-4.365456821026283,-4.350438047559449,-4.335419274092616,-4.320400500625782,-4.305381727158949,-4.2903629536921155,-4.275344180225282,-4.260325406758448,-4.245306633291614,-4.230287859824781,-4.215269086357948,-4.200250312891114,-4.18523153942428,-4.170212765957447,-4.155193992490613,-4.14017521902378,-4.1251564455569465,-4.110137672090113,-4.095118898623279,-4.080100125156445,-4.065081351689612,-4.050062578222779,-4.035043804755945,-4.020025031289112,-4.005006257822278,-3.989987484355445,-3.9749687108886107,-3.9599499374217775,-3.9449311639549434,-3.92991239048811,-3.914893617021277,-3.899874843554443,-3.8848560700876096,-3.8698372966207764,-3.8548185231539422,-3.839799749687109,-3.824780976220276,-3.8097622027534417,-3.7947434292866085,-3.7797246558197752,-3.764705882352941,-3.749687108886108,-3.734668335419274,-3.7196495619524406,-3.7046307884856073,-3.6896120150187732,-3.67459324155194,-3.659574468085107,-3.6445556946182727,-3.6295369211514394,-3.614518147684606,-3.599499374217772,-3.584480600750939,-3.5694618272841057,-3.5544430538172715,-3.5394242803504383,-3.524405506883604,-3.509386733416771,-3.4943679599499378,-3.4793491864831037,-3.4643304130162704,-3.449311639549437,-3.434292866082603,-3.41927409261577,-3.4042553191489366,-3.3892365456821025,-3.3742177722152693,-3.359198998748436,-3.344180225281602,-3.3291614518147687,-3.3141426783479346,-3.2991239048811014,-3.284105131414268,-3.269086357947434,-3.254067584480601,-3.2390488110137676,-3.2240300375469335,-3.2090112640801003,-3.193992490613267,-3.178973717146433,-3.1639549436795997,-3.1489361702127665,-3.1339173967459324,-3.118898623279099,-3.103879849812265,-3.088861076345432,-3.0738423028785986,-3.0588235294117645,-3.0438047559449313,-3.028785982478098,-3.013767209011264,-2.9987484355444307,-2.9837296620775975,-2.9687108886107634,-2.95369211514393,-2.938673341677097,-2.923654568210263,-2.9086357947434296,-2.8936170212765955,-2.8785982478097623,-2.863579474342929,-2.848560700876095,-2.8335419274092617,-2.8185231539424285,-2.8035043804755944,-2.788485607008761,-2.773466833541928,-2.758448060075094,-2.7434292866082606,-2.7284105131414274,-2.7133917396745932,-2.69837296620776,-2.683354192740926,-2.6683354192740927,-2.6533166458072595,-2.6382978723404253,-2.623279098873592,-2.608260325406759,-2.593241551939925,-2.5782227784730916,-2.5632040050062583,-2.5481852315394242,-2.533166458072591,-2.5181476846057578,-2.5031289111389237,-2.4881101376720904,-2.4730913642052563,-2.458072590738423,-2.44305381727159,-2.4280350438047558,-2.4130162703379225,-2.3979974968710893,-2.382978723404255,-2.367959949937422,-2.3529411764705888,-2.3379224030037546,-2.3229036295369214,-2.307884856070088,-2.292866082603254,-2.277847309136421,-2.2628285356695867,-2.2478097622027535,-2.2327909887359203,-2.217772215269086,-2.202753441802253,-2.1877346683354197,-2.1727158948685856,-2.1576971214017524,-2.142678347934919,-2.127659574468085,-2.112640801001252,-2.0976220275344186,-2.0826032540675845,-2.0675844806007513,-2.052565707133917,-2.037546933667084,-2.0225281602002507,-2.0075093867334166,-1.9924906132665834,-1.9774718397997502,-1.962453066332916,-1.9474342928660828,-1.9324155193992496,-1.9173967459324155,-1.9023779724655823,-1.887359198998749,-1.872340425531915,-1.8573216520650817,-1.8423028785982476,-1.8272841051314144,-1.8122653316645811,-1.797246558197747,-1.7822277847309138,-1.7672090112640806,-1.7521902377972465,-1.7371714643304133,-1.72215269086358,-1.707133917396746,-1.6921151439299127,-1.6770963704630795,-1.6620775969962454,-1.6470588235294121,-1.632040050062578,-1.6170212765957448,-1.6020025031289116,-1.5869837296620775,-1.5719649561952442,-1.556946182728411,-1.541927409261577,-1.5269086357947437,-1.5118898623279104,-1.4968710888610763,-1.4818523153942431,-1.46683354192741,-1.4518147684605758,-1.4367959949937426,-1.4217772215269084,-1.4067584480600752,-1.391739674593242,-1.3767209011264079,-1.3617021276595747,-1.3466833541927414,-1.3316645807259073,-1.316645807259074,-1.3016270337922409,-1.2866082603254068,-1.2715894868585735,-1.2565707133917403,-1.2415519399249062,-1.226533166458073,-1.2115143929912389,-1.1964956195244056,-1.1814768460575724,-1.1664580725907383,-1.151439299123905,-1.1364205256570719,-1.1214017521902377,-1.1063829787234045,-1.0913642052565713,-1.0763454317897372,-1.061326658322904,-1.0463078848560707,-1.0312891113892366,-1.0162703379224034,-1.0012515644555693,-0.9862327909887361,-0.9712140175219028,-0.9561952440550687,-0.9411764705882355,-0.9261576971214023,-0.9111389236545682,-0.8961201501877349,-0.8811013767209017,-0.8660826032540676,-0.8510638297872344,-0.8360450563204012,-0.821026282853567,-0.8060075093867338,-0.7909887359198997,-0.7759699624530665,-0.7609511889862333,-0.7459324155193992,-0.7309136420525659,-0.7158948685857327,-0.7008760951188986,-0.6858573216520654,-0.6708385481852321,-0.655819774718398,-0.6408010012515648,-0.6257822277847316,-0.6107634543178975,-0.5957446808510642,-0.5807259073842301,-0.5657071339173969,-0.5506883604505637,-0.5356695869837296,-0.5206508135168963,-0.5056320400500631,-0.490613266583229,-0.4755944931163958,-0.46057571964956256,-0.44555694618272845,-0.43053817271589523,-0.415519399249062,-0.4005006257822279,-0.38548185231539467,-0.37046307884856056,-0.35544430538172733,-0.3404255319148941,-0.32540675844806,-0.31038798498122677,-0.29536921151439355,-0.28035043804755944,-0.2653316645807262,-0.250312891113893,-0.23529411764705888,-0.22027534418022565,-0.20525657071339154,-0.19023779724655832,-0.1752190237797251,-0.16020025031289098,-0.14518147684605776,-0.13016270337922453,-0.11514392991239042,-0.1001251564455572,-0.08510638297872397,-0.07008760951188986,-0.055068836045056635,-0.04005006257822341,-0.0250312891113893,-0.010012515644556075,0.005006257822277149,0.020025031289110373,0.035043804755945374,0.0500625782227786,0.06508135168961182,0.08010012515644505,0.09511889862327827,0.11013767209011327,0.1251564455569465,0.14017521902377972,0.15519399249061294,0.17021276595744617,0.1852315394242794,0.2002503128911144,0.21526908635794761,0.23028785982478084,0.24530663329161406,0.2603254067584473,0.2753441802252805,0.2903629536921155,0.30538172715894873,0.32040050062578196,0.3354192740926152,0.3504380475594484,0.3654568210262834,0.38047559449311663,0.39549436795994986,0.4105131414267831,0.4255319148936163,0.4405506883604495,0.4555694618272845,0.47058823529411775,0.485607008760951,0.5006257822277842,0.5156445556946174,0.5306633291614524,0.5456821026282856,0.5607008760951189,0.5757196495619521,0.5907384230287853,0.6057571964956185,0.6207759699624535,0.6357947434292868,0.65081351689612,0.6658322903629532,0.6808510638297864,0.6958698372966197,0.7108886107634547,0.7259073842302879,0.7409261576971211,0.7559449311639543,0.7709637046307876,0.7859824780976226,0.8010012515644558,0.816020025031289,0.8310387984981222,0.8460575719649555,0.8610763454317887,0.8760951188986237,0.8911138923654569,0.9061326658322901,0.9211514392991234,0.9361702127659566,0.9511889862327916,0.9662077596996248,0.981226533166458,0.9962453066332912,1.0112640801001245,1.0262828535669577,1.0413016270337927,1.056320400500626,1.0713391739674591,1.0863579474342924,1.1013767209011256,1.1163954943679588,1.1314142678347938,1.146433041301627,1.1614518147684603,1.1764705882352935,1.1914893617021267,1.2065081351689617,1.221526908635795,1.2365456821026282,1.2515644555694614,1.2665832290362946,1.2816020025031278,1.2966207759699628,1.311639549436796,1.3266583229036293,1.3416770963704625,1.3566958698372957,1.3717146433041307,1.386733416770964,1.4017521902377972,1.4167709637046304,1.4317897371714636,1.4468085106382969,1.4618272841051319,1.476846057571965,1.4918648310387983,1.5068836045056315,1.5219023779724647,1.536921151439298,1.551939924906133,1.5669586983729662,1.5819774718397994,1.5969962453066326,1.6120150187734659,1.6270337922403009,1.642052565707134,1.6570713391739673,1.6720901126408005,1.6871088861076338,1.702127659574467,1.717146433041302,1.7321652065081352,1.7471839799749684,1.7622027534418017,1.7772215269086349,1.7922403003754699,1.807259073842303,1.8222778473091363,1.8372966207759696,1.8523153942428028,1.867334167709636,1.882352941176471,1.8973717146433042,1.9123904881101375,1.9274092615769707,1.942428035043804,1.9574468085106371,1.9724655819774721,1.9874843554443054,2.0025031289111386,2.017521902377972,2.032540675844805,2.04755944931164,2.0625782227784732,2.0775969962453065,2.0926157697121397,2.107634543178973,2.122653316645806,2.137672090112641,2.1526908635794744,2.1677096370463076,2.182728410513141,2.197747183979974,2.212765957446809,2.2277847309136423,2.2428035043804755,2.2578222778473087,2.272841051314142,2.287859824780975,2.30287859824781,2.3178973717146434,2.3329161451814766,2.34793491864831,2.362953692115143,2.3779724655819763,2.3929912390488113,2.4080100125156445,2.4230287859824777,2.438047559449311,2.453066332916144,2.468085106382979,2.4831038798498124,2.4981226533166456,2.513141426783479,2.528160200250312,2.5431789737171453,2.5581977471839803,2.5732165206508135,2.5882352941176467,2.60325406758448,2.618272841051313,2.633291614518148,2.6483103879849814,2.6633291614518146,2.678347934918648,2.693366708385481,2.7083854818523143,2.7234042553191493,2.7384230287859825,2.7534418022528158,2.768460575719649,2.783479349186482,2.7984981226533154,2.8135168961201504,2.8285356695869837,2.843554443053817,2.85857321652065,2.8735919899874833,2.8886107634543183,2.9036295369211516,2.918648310387985,2.933667083854818,2.9486858573216512,2.9637046307884845,2.9787234042553195,2.9937421777221527,3.008760951188986,3.023779724655819,3.0387984981226523,3.0538172715894873,3.0688360450563206,3.083854818523154,3.098873591989987,3.1138923654568202,3.1289111389236535,3.1439299123904885,3.1589486858573217,3.173967459324155,3.188986232790988,3.2040050062578214,3.2190237797246546,3.2340425531914896,3.249061326658323,3.264080100125156,3.2790988735919893,3.2941176470588225,3.3091364205256575,3.3241551939924907,3.339173967459324,3.354192740926157,3.3692115143929904,3.3842302878598236,3.3992490613266586,3.414267834793492,3.429286608260325,3.4443053817271583,3.4593241551939915,3.4743429286608265,3.4893617021276597,3.504380475594493,3.519399249061326,3.5344180225281594,3.5494367959949926,3.5644555694618276,3.579474342928661,3.594493116395494,3.6095118898623273,3.6245306633291605,3.6395494367959955,3.6545682102628287,3.669586983729662,3.684605757196495,3.6996245306633284,3.7146433041301616,3.7296620775969966,3.74468085106383,3.759699624530663,3.7747183979974963,3.7897371714643295,3.8047559449311628,3.8197747183979978,3.834793491864831,3.849812265331664,3.8648310387984974,3.8798498122653307,3.8948685857321657,3.909887359198999,3.924906132665832,3.9399249061326653,3.9549436795994986,3.9699624530663318,3.9849812265331668,4.0],"w_lo":-8.0,"w_hi":4.0,"retain":0.9,"alpha_min":0.286,"alpha_max":1.714,"beta_min":0.143,"beta_max":0.857,"alpha_c":1.0,"beta_c":0.5};

// All helper functions are unchanged...
function dot(a,b) { let s=0.0; for (let i=0;i<a.length;++i) s+=a[i]*b[i]; return s; }
function eigMatrix(E) { const M = (E && E.x && Array.isArray(E.x)) ? E.x : E; return M.map(row => row.map(Number)); }
function buildM(alpha,beta) { const n=DATA.D.length, M=new Array(n); const da=alpha-DATA.alpha_c, db=beta-DATA.beta_c; for (let i=0;i<n;++i) { const row=new Array(n); for (let j=0;j<n;++j) row[j]=DATA.D[i][j]+da*DATA.S1[i][j]+db*DATA.S2[i][j]; M[i]=row; } for (let i=0;i<n;++i) for (let j=i+1;j<n;++j) { const s=0.5*(M[i][j]+M[j][i]); M[i][j]=s; M[j][i]=s; } return M; }
function keepWindow(n, retain) { const k=Math.max(1,Math.min(Math.round(retain*n),n)); const left=Math.floor((n-k)/2), right=left+k; return {left,right,k}; }
function rbColor(t) { const tmin=0.08, tmax=0.92; const x=tmin + Math.min(1,Math.max(0,t))*(tmax-tmin); const stops=[ [0.0, 220, 60,  52], [0.5, 128, 64, 128], [1.0,  52, 90, 220] ]; let i=0; while (i+1<stops.length && stops[i+1][0] < x) ++i; const a=stops[i], b=stops[i+1]||stops[i]; const f=(x-a[0])/Math.max(1e-9,(b[0]-a[0])); const r=Math.round(a[1]+f*(b[1]-a[1])); const g=Math.round(a[2]+f*(b[2]-a[2])); const bl=Math.round(a[3]+f*(b[3]-a[3])); return "rgb("+r+","+g+","+bl+")"; }
function cutoffTrace() { return { x: [CUTOFF_W, CUTOFF_W], y: [0, 30], mode: "lines", type: "scatter", line: {color: "#2ca02c", width: 2, dash: "dash"}, hoverinfo: "skip", showlegend: false, xaxis: "x", yaxis: "y" }; }
function computeStrengthAndEig(alpha,beta) { const M=buildM(alpha,beta); const EIG=numeric.eig(M); const vals0=Array.from(EIG.lambda.x).map(Number); const EV=eigMatrix(EIG.E); const order=vals0.map((v,i)=>[v,i]).sort((a,b)=>a[0]-b[0]).map(p=>p[1]); const vals=order.map(i=>vals0[i]); const vecs=EV.map(row=>order.map(i=>row[i])); const win = keepWindow(vals.length, DATA.retain); const kept_vals=vals.slice(win.left,win.right); const kept_vecs=vecs.map(row=>row.slice(win.left,win.right)); const fE=[], fB=[]; for (let i=0;i<kept_vals.length;++i) { const Ei=kept_vals[i]; if (Ei>-10 && Ei<15) { const vi=new Array(kept_vecs.length); for (let r=0;r<kept_vecs.length;++r) vi[r]=kept_vecs[r][i]; const proj = dot(vi, DATA.v0); fE.push(Ei); fB.push(proj*proj); } } const Gamma=Math.sqrt(DATA.fold*DATA.fold + Math.pow(DATA.x1+DATA.x2*alpha+DATA.x3*beta,2)); const W=DATA.omega, S=new Array(W.length); for (let j=0;j<W.length;++j) { const w=W[j]; let s=0.0; for (let i=0;i<fE.length;++i) { const dw=w-fE[i]; s += fB[i]*(Gamma/(dw*dw + Gamma*Gamma)); } S[j]=s; } const S_at_E=new Array(fE.length); for (let m=0;m<fE.length;++m) { const w=fE[m]; let s=0.0; for (let i=0;i<fE.length;++i) { const dw=w-fE[i]; s += fB[i]*(Gamma/(dw*dw + Gamma*Gamma)); } S_at_E[m]=s; } return {S, eigs:fE, S_eigs:S_at_E, kept_count:win.k}; }
function computeEigentracks(beta, NV=NV_TRACKS) { const V0s=numeric.linspace(DATA.alpha_min, DATA.alpha_max, NV); let E0=numeric.eig(buildM(V0s[0], beta)); let v0s=Array.from(E0.lambda.x).map(Number); const ord0=v0s.map((v,i)=>[v,i]).sort((a,b)=>a[0]-b[0]).map(p=>p[1]); v0s=ord0.map(i=>v0s[i]); const n=v0s.length; const win = keepWindow(n, DATA.retain); const Y=new Array(n); for (let i=0;i<n;++i) Y[i]=new Array(V0s.length); for (let j=0;j<V0s.length;++j) { const E=numeric.eig(buildM(V0s[j], beta)); let vals=Array.from(E.lambda.x).map(Number); const ord=vals.map((v,i)=>[v,i]).sort((a,b)=>a[0]-b[0]).map(p=>p[1]); vals=ord.map(i=>vals[i]); for (let i=0;i<n;++i) Y[i][j]=vals[i]; } let ymin=+1e9, ymax=-1e9; for (let i=win.left;i<win.right;++i) { for (let j=0;j<V0s.length;++j) { const v=Y[i][j]; if (v<ymin) ymin=v; if (v>ymax) ymax=v; } } const pad=0.08*(ymax-ymin || 1.0); ymin-=pad; ymax+=pad; const traces_grey=[]; function pushGrey(i){ traces_grey.push({ x:V0s, y:Y[i], mode:"lines", type:"scattergl", line:{width:1.2, color:"rgba(120,120,120,0.45)", dash:"dot"}, hoverinfo:"skip", showlegend:false, xaxis:"x2", yaxis:"y2" }); } for (let i=0;i<win.left;++i) pushGrey(i); for (let i=win.right;i<n;++i) pushGrey(i); const traces_kept=[]; for (let idx=0,i=win.left;i<win.right;++i,++idx){ const c=rbColor(idx/Math.max(1,win.k-1)); traces_kept.push({ x:V0s, y:Y[i], mode:"lines", type:"scattergl", line:{width:2.0, color:c}, hoverinfo:"skip", showlegend:false, xaxis:"x2", yaxis:"y2" }); } return {V0s, traces_kept, traces_grey, ymin, ymax, k:win.k}; }
function buildEigenLines(eigs, heights, k){ const lines=[]; for (let i=0;i<eigs.length;++i){ const ci=Math.min(k-1, i); lines.push({ x:[eigs[i],eigs[i]], y:[0, Math.min(30, heights[i])], mode:"lines", type:"scatter", line:{width:2, color:rbColor(ci/Math.max(1,k-1))}, hoverinfo:"skip", showlegend:false, xaxis:"x", yaxis:"y" }); } return lines; }
function assembleData(alphaNow, betaNow, topPack, tracksPack){ const topLine = { x: DATA.omega, y: topPack.S, mode: "lines", type: "scattergl", line: {width: 4, color: "black"}, name: "Emulator", xaxis: "x", yaxis: "y" }; const marker = { x: [alphaNow, alphaNow], y: [tracksPack.ymin, tracksPack.ymax], mode: "lines", type: "scatter", line: {color:"black", width:3}, hoverinfo: "skip", showlegend:false, xaxis:"x2", yaxis:"y2" }; return [ topLine, cutoffTrace(), ...buildEigenLines( topPack.eigs.filter(w => w>=DATA.w_lo && w<=DATA.w_hi), topPack.S_eigs, tracksPack.k ), ...tracksPack.traces_grey, ...tracksPack.traces_kept, marker ]; }

// Tuning knobs are unchanged
const NV_TRACKS = 81, NV_TRACKS_FAST = 49, NV_TRACKS_FINE = 101, BETA_FAST_DEBOUNCE_MS = 80, BETA_FINE_DELAY_MS = 120, AXIS_TITLE_SIZE = 18, TICK_SIZE = 16, CUTOFF_W = 0.782;

// ---------- initial build ----------
const top0   = computeStrengthAndEig(DATA.alpha_c, DATA.beta_c);
let   tracks = computeEigentracks(DATA.beta_c);
let   lastTopPack = top0;

// MODIFIED: Make the Plotly layout responsive
const layout = {
  autosize: true, // Let the plot fill the container
  margin: {l: 64, r: 28, t: 20, b: 60}, // Adjusted top margin
  paper_bgcolor: "white",
  plot_bgcolor: "white",
  grid: {rows: 2, columns: 1, pattern: "independent", roworder: "top to bottom", rowheights: [0.54, 0.46]},
  font: {size: 16 },
  xaxis:  {
    title: {text: "ω (MeV)", font: {size: 18}},
    range:[DATA.w_lo, DATA.w_hi],
    tickfont: {size: 16},
    gridcolor:"rgba(0,0,0,0.10)"
  },
  yaxis:  {
    title: {text: "S(ω) (1/MeV)", font: {size: 18}},
    range:[0,30],
    tickfont: {size: 16},
    gridcolor:"rgba(0,0,0,0.10)"
  },
  xaxis2: {
    title: {text: "V0<sup>is</sup>", font: {size: 18}},
    range:[DATA.alpha_min, DATA.alpha_max],
    tickfont: {size: 16},
    gridcolor:"rgba(0,0,0,0.10)"
  },
  yaxis2: {
    title: {text: "Eigenvalue (MeV)", font: {size: 18}},
    tickfont: {size: 16},
    gridcolor:"rgba(0,0,0,0.10)",
    range:[tracks.ymin, tracks.ymax]
  },
  showlegend: false
};

Plotly.newPlot(
  "fig",
  assembleData(DATA.alpha_c, DATA.beta_c, top0, tracks),
  layout,
  // MODIFIED: Added responsive: true to the config
  {displaylogo:false, scrollZoom:true, responsive: true}
).then(gd => {

  const alphaEl=document.getElementById("alpha");
  const betaEl =document.getElementById("beta");
  const alphaVal=document.getElementById("alphaVal");
  const betaVal =document.getElementById("betaVal");

  // Title is no longer needed in the plot layout itself
  function setValues(a,b) {
    alphaVal.textContent=a.toFixed(2); 
    betaVal.textContent=b.toFixed(2);
  }

  // Event handlers are slightly simplified as they no longer set a title
  function onAlphaInput(){
    const a=parseFloat(alphaEl.value), b=parseFloat(betaEl.value);
    setValues(a,b);
    lastTopPack = computeStrengthAndEig(a,b);
    const topTraces = [ { x:DATA.omega, y:lastTopPack.S, mode:"lines", type:"scattergl", line:{width:4, color:"black"}, xaxis:"x", yaxis:"y" }, cutoffTrace(), ...buildEigenLines( lastTopPack.eigs.filter(w => w>=DATA.w_lo && w<=DATA.w_hi), lastTopPack.S_eigs, tracks.k ) ];
    const markerIndex = gd.data.length - 1;
    const bottom = gd.data.slice(topTraces.length, markerIndex).concat([gd.data[markerIndex]]);
    Plotly.react(gd, topTraces.concat(bottom), gd.layout);
    Plotly.restyle(gd, { x: [[a, a]] }, [markerIndex]);
  }

  let betaTimerFast = null;
  let betaTimerFine = null;

  function recomputeTracksDebounced(nv, delayMs){
    if (betaTimerFast) window.clearTimeout(betaTimerFast);
    betaTimerFast = window.setTimeout(() => {
      const a=parseFloat(alphaEl.value), b=parseFloat(betaEl.value);
      const newTracks = computeEigentracks(b, nv);
      tracks = newTracks;
      const newLayout = Object.assign({}, gd.layout, { yaxis2: Object.assign({}, gd.layout.yaxis2, {range:[tracks.ymin, tracks.ymax]}) });
      Plotly.react(gd, assembleData(a, b, lastTopPack, tracks), newLayout);
    }, delayMs);
  }

  function refineTracksAfterRelease(){
    if (betaTimerFine) window.clearTimeout(betaTimerFine);
    betaTimerFine = window.setTimeout(() => { recomputeTracksDebounced(NV_TRACKS_FINE, 0); }, BETA_FINE_DELAY_MS);
  }

  function onBetaInput(){
    const a=parseFloat(alphaEl.value), b=parseFloat(betaEl.value);
    setValues(a,b);
    lastTopPack = computeStrengthAndEig(a,b);
    const topTraces = [ { x:DATA.omega, y:lastTopPack.S, mode:"lines", type:"scattergl", line:{width:4, color:"black"}, xaxis:"x", yaxis:"y" }, cutoffTrace(), ...buildEigenLines( lastTopPack.eigs.filter(w => w>=DATA.w_lo && w<=DATA.w_hi), lastTopPack.S_eigs, tracks.k ) ];
    const markerIndex = gd.data.length - 1;
    const bottom = gd.data.slice(topTraces.length, markerIndex).concat([gd.data[markerIndex]]);
    Plotly.react(gd, topTraces.concat(bottom), gd.layout);
    recomputeTracksDebounced(NV_TRACKS_FAST, BETA_FAST_DEBOUNCE_MS);
  }

  alphaEl.addEventListener("input", onAlphaInput);
  betaEl.addEventListener("input", onBetaInput);
  betaEl.addEventListener("change", refineTracksAfterRelease);

  setValues(parseFloat(alphaEl.value), parseFloat(betaEl.value));
});
</script>
</body>
</html>